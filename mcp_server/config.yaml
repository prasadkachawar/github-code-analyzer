# MCP Server Configuration for Static Analysis GitHub Integration

# Environment Variables Required:
# - GITHUB_TOKEN: GitHub Personal Access Token for repository access
# - OPENAI_API_KEY: OpenAI API key for LLM integration (if using GPT models)
# - ANTHROPIC_API_KEY: Anthropic API key for Claude integration
# - EMAIL_USER: SMTP email username
# - EMAIL_PASSWORD: SMTP email password or app-specific password
# - FROM_EMAIL: Email address to send reports from

# GitHub Integration Settings
github:
  token_env: "GITHUB_TOKEN"
  webhook_secret_env: "GITHUB_WEBHOOK_SECRET"
  api_base_url: "https://api.github.com"
  clone_depth: 10  # Number of commits to fetch

# LLM Provider Configuration
llm:
  provider: "anthropic"  # Options: "anthropic", "openai" 
  model_config:
    anthropic:
      model: "claude-3-sonnet-20240229"
      max_tokens: 4000
      temperature: 0.1
    openai:
      model: "gpt-4"
      max_tokens: 4000
      temperature: 0.1
  
# Email Configuration
email:
  smtp_server: "smtp.gmail.com"
  smtp_port: 587
  use_tls: true
  timeout: 30
  
# Static Analysis Configuration
analysis:
  # Standards to check
  standards: ["MISRA", "CERT"]
  
  # File extensions to analyze
  file_extensions: [".c", ".cpp", ".cc", ".cxx", ".h", ".hpp", ".hh", ".hxx"]
  
  # Maximum files to analyze per commit (performance limit)
  max_files_per_commit: 50
  
  # Analysis timeout in seconds
  timeout: 300
  
  # Include AI explanations in reports
  include_ai_explanations: true

# Report Generation
reports:
  format: "html"  # Options: "html", "markdown", "json"
  include_source_context: true
  max_violations_per_severity: 10  # Limit violations shown per severity level
  
  # Email subject templates
  email_subjects:
    no_violations: "‚úÖ Clean Code - {repo_name} ({commit_sha})"
    with_violations: "‚ö†Ô∏è Code Issues - {repo_name} ({commit_sha}) - {violation_count} violations"
    critical_violations: "üö® Critical Issues - {repo_name} ({commit_sha}) - {violation_count} violations"

# Webhook Configuration
webhook:
  port: 5000
  host: "0.0.0.0"
  
  # Events to handle
  github_events:
    - "push"
    - "pull_request"
  
  # Branches to analyze (for push events)
  target_branches:
    - "main" 
    - "master"
    - "develop"
  
  # PR actions to handle
  pr_actions:
    - "opened"
    - "synchronize" 
    - "reopened"

# Storage Configuration (for baselines and history)
storage:
  type: "filesystem"  # Options: "filesystem", "s3", "database"
  filesystem:
    reports_dir: "./analysis_reports"
    baselines_dir: "./analysis_baselines"
  
# Logging Configuration
logging:
  level: "INFO"  # Options: DEBUG, INFO, WARNING, ERROR
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  file: "mcp_server.log"

# MCP Server Configuration
mcp:
  server_name: "static-analysis-github-mcp"
  server_version: "1.0.0"
  
  # Available tools
  tools:
    - name: "analyze_commit_changes"
      enabled: true
    - name: "generate_analysis_report" 
      enabled: true
    - name: "send_analysis_email"
      enabled: true
    - name: "clone_and_analyze_repository"
      enabled: true
    - name: "compare_with_baseline"
      enabled: true

# Performance Settings
performance:
  max_concurrent_analyses: 3
  git_clone_timeout: 120
  analysis_timeout: 300
  
# Security Settings  
security:
  verify_webhook_signatures: true
  allowed_repositories: []  # Empty = allow all, or specify list of allowed repo URLs
  rate_limiting:
    max_requests_per_hour: 100
    max_analyses_per_day: 500
